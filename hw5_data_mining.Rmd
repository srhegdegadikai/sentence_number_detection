---
title: '"Word" and Sentence-number Detection'
author: "Suhas Hegde"
date: "October 19, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

The following program reads the text from the file and saves them into a tabular data structure(data-frame). Each new sentence is saved in a new row, thus the data-frame will have 332938 rows. Using 'regex' pattern matching, a new column is created (containing a logical vector/array with True/False values) to indicate whether or not the given word is present in that particular sentence. The 'regex' pattern uses the 'OR' operator for the plural forms of the word. For example, if a sentence contains both "expert" and "experts", it will only count one of them and thus the sentence number is only displayed once in the final result. Finally sentence numbers are displayed in an interactive point-range plot where if we hover over a certain point, it displays the sentence number corresponding to the given word.

```{r}
library(tidyverse) # library for data manipulation
library(tidytext) # text manipulation
library(stringr) # regex and pattern matching in strings
library(tibble) # library that holds the special datastructures
library(ggiraph) # plotting library


# read in the data from the text file
raw_text <- read_delim("sents_BNCbaby.txt", col_names = FALSE, delim = "\n")

# the raw data 
raw_text

# filter out the sentence numbers and create another column
raw_text$X1 %>% str_extract("[0-9]{1,}(?=\t)") -> raw_text$sentence_num

# rename the columns
names(raw_text) <- c("text","sentence_num")

# convert sentence number to numeric type column
as.integer(raw_text$sentence_num) -> raw_text$sentence_num

# build a new dataframe that contains the sentence numbers and the string detection result  for each word
df <- data_frame(
  sentence_num = raw_text$sentence_num,
  priceless = str_detect(raw_text$text, "priceless"),
  valuable = str_detect(raw_text$text, "valuable"),
  absent = str_detect(raw_text$text, "absent"),
  specialist_specialists = str_detect(raw_text$text, "specialist|specialists"),
  expert_experts = str_detect(raw_text$text, "expert|experts"),
  courage = str_detect(raw_text$text, "courage")
)

# the new table/dataframe with the string setection results
glimpse(df)


# convert the data into long form data and filter out only those rows that contain actual detection,
# ie, rows with values that say 'TRUE'
df %>% gather(word, detection, priceless:courage) %>% filter(detection == TRUE) %>%
  select(sentence_num, word) -> df


# plot the sentence numbers for each different word
df %>% ggplot(., aes(word, sentence_num)) +
  geom_point_interactive(aes(tooltip = sentence_num, color=word), size=1.75, alpha = .75) +
  coord_flip()  +
  theme(legend.position = "none") -> gg

ggiraph(code = print(gg))

```

